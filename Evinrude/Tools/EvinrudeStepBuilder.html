<html>
<head>
<title>Evinrude Step Builder</title>
<script language="javascript" type="text/javascript">
	function saveTableToJson(tableID) {
		try {
			//alert("working");
			var strKeyName = "";
			var saveText = "";
			var table = document.getElementById(tableID);
			var rowCount = table.rows.length;

			//alert("rowCount = " + rowCount);
			for (var intRow = 1; intRow < rowCount; intRow++) {
				var eachRow = table.rows[intRow];
				//	var row = table.rows[i];
				//var newRow = table.insertRow(intRow);
				var colCount = eachRow.cells.length;
				//alert("colCount = " + colCount);
				for (var intCol = 0; intCol < colCount; intCol++) {
					//alert("intCol = " + intCol);
					//var newcell = eachRow.insertCell(intCol);
					var eachCell = eachRow.cells[intCol];
					//newcell.innerHTML = eachRow.cells[intCol].innerHTML;
					//alert(table.rows[intRow].cells[intCol].innerHTML);
					// 					alert(eachCell.innerHTML);
					// 					alert(eachCell.childNodes[0].type);
					strKeyName = table.rows[0].cells[intCol].innerHTML

				//	alert(strKeyName);
					switch (eachCell.childNodes[0].type) {
					case "text":
						//saveText = saveText + "|" + eachCell.childNodes[0].value;
						saveText = saveText + "|" + strKeyName + ":" + eachCell.childNodes[0].value;
						//alert(saveText);
						break;
					case "select-one":
						//saveText = saveText + "|" + eachCell.childNodes[0].options[eachCell.childNodes[0].selectedIndex].innerHTML;

						saveText = saveText + "|" + strKeyName + ":" + eachCell.childNodes[0].options[eachCell.childNodes[0].selectedIndex].innerHTML;
					//	alert(saveText);
						//saveText = saveText + "|" + eachCell.childNodes[0].selectedIndex;
						break;
					}
				}
			}
		} catch (e) {
			alert(e);
		}

		var ForAppending = 8;
		var ForWriting = 2
		var TriStateFalse = 0;
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		var newFile = fso.OpenTextFile("C:\\Users\\jxp30\\Documents\\GitHub\\Evinrude\\Evinrude\\Tools\\savefile.txt", ForWriting, true, TriStateFalse);
		newFile.Write(saveText);
		newFile.Close();
	}

	//     z = 1
	//     sJsonConverted.Cells(z, 1) = "{"
	//     z = z + 1
	//     sJsonConverted.Cells(z, 1) = Chr(34) & "test steps" & ":" & Chr(34)
	//     z = z + 1
	//     sJsonConverted.Cells(z, 1) = "["
	//     z = z + 1
	//     For y = 2 To 20
	//         sJsonConverted.Cells(z, 1) = "{"
	//         z = z + 1
	//         For x = 1 To 18
	//             If x = 18 Then
	//                 sJsonConverted.Cells(z, 1) = Chr(34) & sSource.Cells(1, x) & Chr(34) & ":" & Chr(34) & sSource.Cells(y, x) & Chr(34)
	//             Else
	//                 sJsonConverted.Cells(z, 1) = Chr(34) & sSource.Cells(1, x) & Chr(34) & ":" & Chr(34) & sSource.Cells(y, x) & Chr(34) & ","
	//             End If
	//             z = z + 1
	//         Next x
	//         sJsonConverted.Cells(z, 1) = "},"
	//         z = z + 1
	//     Next y
	//     z = z - 1
	//     sJsonConverted.Cells(z, 1) = "}"
	//     z = z + 1
	//     sJsonConverted.Cells(z, 1) = "]"
	//     z = z + 1
	//     sJsonConverted.Cells(z, 1) = "}"
	//     z = z + 1

	function saveFile() {
		var ForAppending = 8;
		var ForWriting = 2
		var TriStateFalse = 0;
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		var newFile = fso.OpenTextFile("C:\\Users\\jxp30\\Documents\\GitHub\\Evinrude\\Evinrude\\Tools\\savefile.txt", ForWriting, true, TriStateFalse);
		newFile.Write("saving inside the stepbuilder");
		newFile.Close();
	}

	function addRow(tableID) {
		var table = document.getElementById(tableID);
		var rowCount = table.rows.length;
		var row = table.insertRow(rowCount);
		var colCount = table.rows[0].cells.length;
		for (var i = 0; i < colCount; i++) {
	var newcell = row.insertCell(i);
			newcell.innerHTML = table.rows[rowCount - 1].cells[i].innerHTML;
			//alert(newcell.childNodes[0].type);
			switch (newcell.childNodes[0].type) {
			case "text":
				newcell.childNodes[0].value = "";
				break;
			case "checkbox":
				newcell.childNodes[0].checked = false;
				break;
			case "select-one":
				newcell.childNodes[0].selectedIndex = 0;
				break;
			}
			//alert(newcell.childNodes[0].type);
		}
	}

	function insertRow(tableID) {
		var table = document.getElementById(tableID);
		var rowCount = table.rows.length;
		for (var intRow = 0; intRow < rowCount; intRow++) {
			var eachRow = table.rows[intRow];
			var chkbox = eachRow.cells[0].childNodes[0];
			if (null != chkbox && true == chkbox.checked) {
				var newRow = table.insertRow(intRow);
				var colCount = eachRow.cells.length;
				for (var intCol = 0; intCol < colCount; intCol++) {
					var newcell = newRow.insertCell(intCol);
					newcell.innerHTML = eachRow.cells[intCol].innerHTML;
					switch (newcell.childNodes[0].type) {
					case "text":
						newcell.childNodes[0].value = "";
						break;
					case "checkbox":
						newcell.childNodes[0].checked = false;
						break;
					case "select-one":
						newcell.childNodes[0].selectedIndex = 0;
						break;
					}
				}
				break;
			}
		}
	}

	function deleteRow(tableID) {
		try {
			var table = document.getElementById(tableID);
			var rowCount = table.rows.length;
			for (var i = 0; i < rowCount; i++) {
				var row = table.rows[i];
				var chkbox = row.cells[0].childNodes[0];
				if (null != chkbox && true == chkbox.checked) {
					if (rowCount <= 2) {
						alert("Cannot delete all the rows.");
						break;
					}
					table.deleteRow(i);
					rowCount--;
					i--;
				}
			}
		} catch (e) {
			alert(e);
		}
	}
</script>
</head>
<body>
	<input type="button" value="Add Row" onclick="addRow('dataTable')"></input>
	<input type="button" value="Insert Row" onclick="insertRow('dataTable')"></input>
	<input type="button" value="Delete Row" onclick="deleteRow('dataTable')"></input>
	<select id="fileName">
		<option value="">file name</option>
	</select>
	<input type="button" value="saveTableToJson" onclick="saveTableToJson('dataTable')"></input>
	<input type="button" value="Save File" onclick="saveFile()"></input>
	<table id="dataTable" width="350px" border="1">
		<tr>
			<th>+</th>
			<th>strAction</th>
			<th>strTagName</th>
			<th>strAttributeNames</th>
			<th>strAttributeValues</th>
			<th>strInputValue</th>
			<th>strLogicalName</th>
			<th>intMillisecondsToWait</th>
			<th>blnOptional</th>
			<th>strAssert</th>
			<th>blnPleaseWait</th>
			<th>blnHighlight</th>
			<th>blnScreenshot</th>
			<th>strFunction</th>
			<th>strAssistiveProperties</th>
			<th>blnExitOnFail</th>
			<th>strOutputLinkName</th>
			<th>strOutputValue</th>
			<th>intLoop</th>
		</tr>
		<tr>
			<td><input type="checkbox" name="chk"></input></td>
			<td><select id="strAction">
					<option value=""></option>
					<option value="launch">launch</option>
					<option value="close">close</option>
					<option value="get">get</option>
					<option value="set">set</option>
					<option value="verify">verify</option>
					<option value="sync_visible">sync_visible</option>
					<option value="sync_hidden">sync_hidden</option>
					<option value="sync_enabled">sync_enabled</option>
					<option value="sync_disabled">sync_disabled</option>
					<option value="break">break</option>
			</select></td>
			<td><select id="strTagName">
					<option value=""></option>
					<option value="a">a</option>
					<option value="alert">alert</option>
					<option value="button">button</option>
					<option value="div">div</option>
					<option value="h1">h1</option>
					<option value="img">img</option>
					<option value="img">input</option>
					<option value="p">p</option>
					<option value="select">select</option>
					<option value="span">span</option>
					<option value="table">table</option>
					<option value="td">td</option>
					<option value="textarea">textarea</option>
					<option value="th">th</option>
					<option value="tr">tr</option>
			</select></td>


			<td><input type="text" id="strAttributeNames" value="text"></input></td>

			<td><input type="text" id="strAttributeValues"></input></td>
			<td><input type="text" id="strInputValue"></input></td>
			<td><input type="text" id="strLogicalName"></input></td>
			<td><input type="text" id="intMillisecondsToWait"></input></td>
			<td><select id="blnOptional">
					<option value=""></option>
					<option value="">true</option>
					<option value="">false</option>
			</select></td>
			<td><input type="text" id="strAssert"></input></td>
			<td><select id="blnPleaseWait">
					<option value=""></option>
					<option value="">true</option>
					<option value="">false</option>
			</select></td>
			<td><select id="blnHighlight">
					<option value=""></option>
					<option value="">true</option>
					<option value="">false</option>
			</select></td>
			<td><select id="blnScreenshot">
					<option value=""></option>
					<option value="">true</option>
					<option value="">false</option>
			</select></td>
			<td><input type="text" id="strFunction"></input></td>
			<td><input type="text" id="strAssistiveProperties"></input></td>
			<td><select id="blnExitOnFail">
					<option value=""></option>
					<option value="">true</option>
					<option value="">false</option>
			</select></td>
			<td><input type="text" id="strOutputLinkName"></input></td>
			<td><input type="text" id="strOutputValue"></input></td>
			<td><input type="text" id="intLoop"></input></td>
		</tr>
	</table>
</body>
</html>